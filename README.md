# node-whatsapp-bot-api

## Что использовать?

- БД MongoDB;
- Фреймворк backend <https://www.npmjs.com/package/express>;
- Фреймворк frontend Angular;
- Библиотека для работы с Whatsapp <https://www.npmjs.com/package/whatsapp-web.js>;
- Docker;

## Что делать?

1. Подсистема для для работы с whatsapp со своим api и БД;

    1.1. Api;

        1.1.1. Получение сообщений с фильтрацией по дате, содержанию, пользователям(группам); (r, rw)
        1.1.2. Отправить сообщения пользователям; (w, rw)
        1.1.3. Получить пользователей(группы) с фильтрацией;  (r, rw)
        1.1.4. Авторизация; (w, rw)
        1.1.5. Деавторизация;  (w, rw)
        1.1.6. Получить скриншот экрана;  (r, rw)
        1.1.7. Healthcheck; (доступен без токена)
        1.1.8. Получение статистики; (r, w, rw)
        1.1.9. Получение пользователя по id; (r, rw)
        1.1.10. Получение сообщения по id; (r, rw)
        1.1.11. Получение прав токена; (r, w, rw)

    1.2. Внутренний api (доступен только из основного бекенда);

        1.2.1. Создание токена доступа с правами r (только чтение), w (только запись), rw (чтение и запись);
        1.2.2. Удаление токена;
        1.2.3. Изменение прав токена;
        1.2.4. Получение списка токенов доступа;

    1.3. Подсистема должна сохранять все сообщения и пользователей в БД в фоновом режиме;

    1.4. Подсистема должна слать события о новых сообщениях во внешнюю систему;

2. Основной backend;

    2.1. Api;

        2.1.1. Регистрация нового пользователя;
        2.1.2. Авторизация и деавторизация;
        2.1.3. Внесение денег на баланс пользователя (эмуляция);
        2.1.4. Создание нового экземпляра подсистемы Whatsapp (создаётся и запускается новый контейнер в докере);
        2.1.5. Удаление экземпляра подсистемы Whatsapp (удаляется контейнер);
        2.1.6. Получение токена доступа к подсистеме;
        2.1.7. Удаление токена доступа к подсистеме;
        2.1.8. Изменение прав токена доступа к подсистеме;
        2.1.9. Получить список созданных экземпляров;
        2.1.10. Получить экземпляр по id;
        2.1.11. Получить информацию о стоимости одного экземпляра;

    2.2. Каждый день в 00:00 по Гринвичу отнимать с баланса пользователей сумму за месяц (у тех у которых прошёл месяц с прошлого списания). Если средств недостаточно останавливать контейнер. Если средства не вносятся до следующего списания, то удалить контейнер.

3. Фронтенд;

    3.1. страница авторизации и регистрации;
    3.2. Страница со списком запущенных экземпляров;
    3.3. Страница профиля;
    3.4. Страница пополнения кощелька;
    3.5. Страница экземпляра с возможностью протестировать методы подсистемы;
    3.6. Страница с токенами экземпляра;
